<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Servicio de Grúa - [Audrey Grua]</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
            min-height: 100vh; /* Para que el footer esté al final de la página */
            display: flex;
            flex-direction: column;
        }
        header {
            background-color: #333;
            color: #fff;
            padding: 10px 0;
            text-align: center;
        }
        section {
            padding: 20px;
            flex: 1; /* Para que el contenido principal se expanda */
        }
        footer {
            background-color: #333;
            color: #fff;
            text-align: center;
            padding: 10px 0;
        }
        .paypal-button-container {
            text-align: center;
            margin-top: 20px;
        }
    </style>
</head>
<body>

<header>
    <h1>Servicio de Grúa [Audrey Grua]</h1>
</header>

<section>
    <h2>Servicios Ofrecidos</h2>
    <p>Ofrecemos remolque de vehículos, asistencia en carretera, y mucho más.</p>
</section>

<section>
    <h2>Contacta con Nosotros</h2>
    <form>
        <label for="nombre">Nombre:</label><br>
        <input type="text" id="nombre" name="nombre" required><br><br>
        <label for="email">Correo Electrónico:</label><br>
        <input type="email" id="email" name="email" required><br><br>
        <label for="telefono">Teléfono:</label><br>
        <input type="tel" id="telefono" name="telefono" required><br><br>
        <label for="mensaje">Descripción del Problema:</label><br>
        <textarea id="mensaje" name="mensaje" rows="4" cols="50" required></textarea><br><br>
        <button type="submit">Enviar</button>
    </form>
</section>

<div class="paypal-button-container">
    <h2>Paga Ahora</h2>
    <div id="paypal-button"></div>
</div>

<footer>
    <p>© 2024 [Audrey Grua]. Todos los derechos reservados.</p>
</footer>

<script src="https://www.paypal.com/sdk/js?client-id=ASlfuJBzhOajtPPymKrRs4dsW_wGJUYTRw5XYawu5E9rNBVptVEdijKinc3Dzz47aXyLiy8pvfA7Rp-q&currency=USD"></script>
<script>
    paypal.Buttons({
        createOrder: function(data, actions) {
            return actions.order.create({
                purchase_units: [{
                    amount: {
                        value: '99.99' // Aquí defines el monto del servicio
                    },
                    description: "Servicio de Grúa - [Audrey Grua]"
                }]
            });
        },
        onApprove: function(data, actions) {
            return actions.order.capture().then(function(details) {
                alert('Pago completado por ' + details.payer.name.given_name);
            });
        },
        onError: function(err) {
            console.error('Error durante el pago:', err);
            alert('Ocurrió un error durante el pago. Por favor, inténtalo nuevamente.');
        }
    }).render('#paypal-button');

    document.getElementById("shipping-edit-button").addEventListener("click", async () => {
        if (memberAuthenticatedSuccessfully) {
            const { selectionChanged, selectedAddress } = await profile.showShippingAddressSelector();
            if (selectionChanged) {
                console.
                    log("New address:", selectedAddress);
                shippingAddress = selectedAddress;
                setShippingSummary(shippingAddress);
                paymentComponent.setShippingAddress(shippingAddress);
            }
        } else {
            setActiveSection(shippingSection);
        }
    });

    document.getElementById("payment-edit-button").addEventListener("click", () => setActiveSection(paymentSection));

    checkoutButton.addEventListener("click", async () => {
        checkoutButton.setAttribute("disabled", "");
        try {
            paymentToken = await paymentComponent.getPaymentToken();
            console.log("Payment token:", paymentToken);
            const headers = new Headers();
            headers.append("Content-Type", "application/json");
            const isShippingRequired = form.elements["shipping-required"].checked;
            const body = JSON.stringify({
                ...(isShippingRequired && { shippingAddress }),
                paymentToken,
            });
            const response = await fetch("transaction", {
                method: "POST",
                headers,
                body,
            });
            const { result, error } = await response.json();
            if (error) {
                console.error(error);
            } else {
                if (result.id) {
                    const message = Order ${result.id}: ${result.status};
                    console.log(message);
                    alert(message);
                } else {
                    console.error(result);
                }
            }
        } finally {
            checkoutButton.removeAttribute("disabled");
        }
    });
</script>

</body>
</html>
